// ****************************************************************************
//
//          Aevol - An in silico experimental evolution platform
//
// ****************************************************************************
// 
// Copyright: See the AUTHORS file provided with the package or <www.aevol.fr>
// Web: http://www.aevol.fr/
// E-mail: See <http://www.aevol.fr/contact/>
// Original Authors : Guillaume Beslon, Carole Knibbe, David Parsons
// 
// This program is free software: you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation, either version 2 of the License, or
// (at your option) any later version.
// 
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
// 
// You should have received a copy of the GNU General Public License
// along with this program.  If not, see <http://www.gnu.org/licenses/>.
// 
//*****************************************************************************




// =================================================================
//                              Libraries
// =================================================================
#include <string.h>



// =================================================================
//                            Project Files
// =================================================================
#include "Test_ae_dna.h"
#include <ae_macros.h>
#include <ae_genetic_unit.h>
#include <ae_rna.h>
#include <ae_protein.h>
#include <ae_params_mut.h>
#include <ae_individual.h>



// ===========================================================================
//                             Declare Used Namespaces
// ===========================================================================




//############################################################################
//                                                                           #
//                         Class Test_ae_dna                                 #
//                                                                           #
//############################################################################
CPPUNIT_TEST_SUITE_REGISTRATION( Test_ae_dna );

// ===========================================================================
//                               Static attributes
// ===========================================================================

// ===========================================================================
//                                  Constructors
// ===========================================================================
Test_ae_dna::Test_ae_dna( void )
{
}

// ===========================================================================
//                                  Destructors
// ===========================================================================
Test_ae_dna::~Test_ae_dna( void )
{
}

// ===========================================================================
//                                   Operators
// ===========================================================================

// ===========================================================================
//                                 Public Methods
// ===========================================================================
void Test_ae_dna::setUp( void )
{
  // Build indiv1
  ae_params_mut params_mut;
  char * gu1_genome = new char [101];
  char * gu2_genome = new char [101];
  for (int32_t i=0;i<50;i++)
  {
    gu1_genome[i]='1';
    gu1_genome[i+50]='1';
    gu2_genome[i]='2';
    gu2_genome[i+50]='2';

  }
  gu1_genome[100]=0;
  gu2_genome[100]=0;
  
  char * gu3 = new char[3713];
  sprintf(gu3,"1010011111111100110000001101010010000111010111011001101000101101111000101101101000100010100100000101011110001010101111100110010010011100111001011010001010000101110011011001100101101100010100100100111000110101011100000111110111000110011101001110110101100110010000111100110011110001111011111001010100000000100101100101100110000101101110011010110010111001111001001100000111011001110001111100011010101000011011110010001001101100100001011011010011000001111111101101001000100110001001010101011111101010111111101011110111100110000001000010100011001111100001110011001100110001110011000010011111001100001111101001111011101110111000011110100010110100100101001101000110110000011000001110111000011100100111011001111011110011010011011101010111110001011110011101101100000110001001011111010010111010000111010011001110101101100110001101000110111100000100100001010110100001001010011001111000111011111011101010011001011111011100110000010000111111111101101010100111111001011100010111111010001000001011001000010000101001001100101101100111111110000001010110000011000010110110011011110011010001011111101010000001111101101000001001100000011000100001011111111111010010101000000011111000010111011101011100001100001111001111110011011110010001001101000101101010100011100000100000110100000000000011110001011111000110101011101101111101111101011010101011010000111000111100000111001011101101001011110011010111100101101111111101010110000010000111000011001100001111011001100101001000110100011001110001000001111100010101001110001100101101011100100101100110010011000101111010111010010110001100011011011001100000101010111000010101111101101011101110101100101110000100101110100010110001111110110110000001001001100101001100111111100110010011010101011000111100010100101000111001000001001010111101010110010101110111111000000101000111000110000011110100010011101001000000011001110110111001010011010111011010011110100010100101001001111111110110010110110001111010110001011000100110001100100001001001101011101000111110001100000111111011111000001010000100110011011101011001101011001010001111111001110001000111101010110011010111011100010010111101000001111001011000010111110010101101000000001110100011010011111011010011111101101000000001110100011101010001000000100110010010110101001011110011101110000110000001010100000010110110110011011010100010110011100111001101000110111010111011000101010100000010100001001010011010101101010111000000010110100100000101111000100001100000101100101111101100101010111000110110011110011111001001110100110101101101001011101000011110001000100010000110100000111100110000011011110011000111001100110011000111100000110011101011110111111001100001000100101010000000101010000001010101011011100110111011010010000000011111001101001001011101101110110010011011101100001001111010101001110000011100011001000111010111001101100001100010110010100110001001011110011001011001111000110010101111010000110011011101000010010011110101111110101111101100010001110100110111111000111111100010110110010111001000110101101100010010001001100001111011111100111011011101001110011011111010110111110010000011101000100110011001110110000000001100010110111101000111111011001000010111000001110011110100100100000100110100010001101011100110110111011101100010110100010000100100001111001001100010001001011011110100001010011001010001101100110101011100111101010100100010100110111000100110001000111011010110110110101111010001011001111100111001111001000110110011101111011001011101011001110010101010010111001011100100110111000100101110101100110101101100110100100110010101111011111011010010001100110010101110001100010111001010111011100011101110010110100001100001010100011010101110100001011010110110010010111111111001011001110111110001000110111100111000001100101110101100011110011001");
  gu3[3712]=0;
  
  char * gu4 = new char[3269];
  sprintf(gu4,"0000111011001001100000011110110001111110111110101101101000001011011100111110010010001100001011100000101010001001101001100001000011001110001000110110001111000100011110010110011111010101001100001100001110100010011101100100011000000101111111011010001111000001001000000011111010111100101110001100101010110100001001010011000101010111100001001111011001100001110100110101101111001001111011111011100111110010110101011100000001000101101001001011011110011100001100110001011001110110110001110111001111110100000000110000100111111000111010110100111111000101100110100011011110010000111010100100000011000111100100011011111100100001001000000010110011011010101000011100100010101110001000101001100101010000111011100011000001110000011101011001010011001010001001100110111101011111000000001111100111000001110100010100110110111101100111001101110010111001010000111001001011001000000000110110101101011101000011010010001010011010110001001000110011111110110100011011101010011111001110001110010111111000000100010101100101010000101011011111011000111011101011100001110010101010011011001100000110101100110110111111001001000000111001011101000101101111000101101101000100010100100000101011110001010101111100110010010011100111001001010001010000101110011011001100101101100010100101100111000110101011100000111110111000110011101001110110101100110010000111100110011110011111011111001010101010101100011110001010001000111001000001001010111101010110010101110111111000000101100011100011000001101010001001110100100000001100111011011100101001101011101101001111010001010010100100111111111011001011011000111101011000101100010011000110010000100100110101110100011111000110000011111111000001010000100110011011101011001101011001010001111100011111001110001000111101010110011010111011100010010111101000001111001011000010111110010101101000000001110100011010011111011010011111101101000000001110100011101010001000000100110010010110101001011100011101110000110000001010100000010110110110011011010100010100011100011001101000110111010111011000011001100111011010010000010000101011001101101001100100101001100101000101101110001001101100010110001011010101011000110010100010110010000100010010011101101010001110011110011100101100101100000001110001011100010000010100111110110000110111110000001010010001001011000010110110111011001001000010100110000101001000110011110110001101011001001100011010010100000111101110111000101100101110101010011101010000011000111011010011100001011110100000111100101100001011111001010110100000000111010001101001111101101001111110110100000000111010001110101000100000010011001001011010100101110001110111000011000000101010000001011011011001101101010001010001110001100110101100011011101011101100001100110011101101001000001000010101100110110100110010010100110010100010110111000100110110001011000101101010101100011001010011011001000010001001001110110101000111001111001110010110010110000000111000101110001000001010011111011000011011111000000101001000001011000010110110111011001001000011100110000101001000110011110110001101011001001100011010010100000111101110000001000101100101101101100100011011111111101010011010100110001101000111011101110011000000111011101000011110110011010101110110111011101100010011010101100111111000001011001000110001101011010111001000110000111010011011001010011110101000110110001000011110000110");
  gu4[3268]=0;
  
  indiv1 = new ae_individual(NULL, NULL, NULL, &params_mut, 1.0, 10, 100, false, 1, 0);
  //indiv1->add_GU(gu1_genome, strlen(gu1_genome));
  indiv1->add_GU(gu3, strlen(gu3));
  indiv1->add_GU(gu4, strlen(gu4));
  dna1=indiv1->get_genetic_unit(0)->get_dna();
  dna2=indiv1->get_genetic_unit(1)->get_dna();
}

void Test_ae_dna::tearDown( void )
{
  delete indiv1;
}

void Test_ae_dna::test1( void )
{
  // Check genome size
  //CPPUNIT_ASSERT(indiv1->get_genetic_unit(0)->get_dna()->get_length()==100);

  
  dna1->inter_GU_ABCDE_to_ACDBE(1809,2554,1238);
  //dna1->inter_GU_ABCDE_to_BDCAE(10,20,60);
  
  printf("\n");
  for (int32_t i=0;i<=dna1->get_length();i++) printf("%c",dna1->get_data()[i]);
  printf("\n");
  for (int32_t i=0;i<=dna2->get_length();i++) printf("%c",dna2->get_data()[i]);
  printf("\n");
  
  
}

// ===========================================================================
//                                Protected Methods
// ===========================================================================

// ===========================================================================
//                              Non inline accessors
// ===========================================================================
